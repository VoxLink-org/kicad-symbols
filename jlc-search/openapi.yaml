openapi: 3.1.0
info:
  title: JLCPCB Smart Component Search
  description: >
    Search for electronic components on JLCPCB/LCSC with real-time stock and pricing.
    Uses specific sub-databases for higher accuracy (e.g., finding exact resistors).
  version: 2.1.0
servers:
  - url: https://jlc-component-search.wanghsinche.workers.dev
paths:
  /search:
    get:
      operationId: searchComponents
      summary: Search JLCPCB catalog with specific category routing.
      description: >
        Search for parts. CRITICAL: Provide the `category` if applicable to get accurate parametric results.
        If the category is unknown, leave it empty for a generic keyword search.
      parameters:
        - name: category
          in: query
          required: false
          schema:
            type: string
            enum: 
              # Passives
              - resistor
              - capacitor
              - inductor
              - potentiometer
              # Discrete
              - diode
              - mosfet
              - bjt
              - led
              # ICs
              - mcu
              - arm
              - risc-v
              - fpga
              # Power
              - ldo
              - regulator
              - buck_boost
              - boost
              # Analog
              - adc
              - dac
              - sensor_gas
              - gyroscope
              # Connectors
              - header
              - usb
              - jst
              - relay
              - switch
              # Display
              - lcd
              - oled
              - led_matrix
              - led_segment
              # Comms
              - wifi
              - io_expander
          description: The component type. Select the closest match.

        - name: value
          in: query
          required: false
          schema:
            type: string
          description: >
            Primary value. 
            Resistors: "10k", "4.7k". 
            Capacitors: "100nF", "10uF". 
            LDOs: "3.3V".
            Inductors: "10uH".
            Headers: Pitch "2.54mm".

        - name: q
          in: query
          required: false
          schema:
            type: string
          description: Generic keywords or Part Number (e.g., "STM32F103", "ADS1292").

        - name: package
          in: query
          required: false
          schema:
            type: string
          description: Footprint (e.g., "0603", "SOIC-8", "LQFP-48").

        # 透传参数，无需一个个定义，LLM 会根据语境自动推断，Worker 会自动透传
        - name: tolerance
          in: query
          required: false
          schema: { type: string }
        
        - name: voltage
          in: query
          required: false
          schema: { type: string }
          description: Voltage rating (e.g. "50V" for caps, output voltage for LDOs).

        - name: limit
          in: query
          schema:
            type: integer
            default: 5

      responses:
        '200':
          description: Component list
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    lcsc_id: { type: string }
                    mfr_part: { type: string }
                    stock: { type: integer }
                    price_usd: { type: number }
                    description: { type: string }
                    datasheet: { type: string }
                    specs: { type: object }